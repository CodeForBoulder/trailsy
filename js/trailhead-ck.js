function startup(){"use strict";function ct(){console.log("initialSetup");bt(function(){if(et)return;xt(B,function(){Lt(function(){Ht(O);p&&Ot(function(){k.getZoom()>=a&&!k.hasLayer(W)&&k.addLayer(W)})})})})}function ht(){yt();xt(j,function(){Ht(O)})}function pt(e,t){var n=$.extend(!0,{},t);$.each(t,function(t,r){if(e.activityFilter)for(var i=0;i<e.activityFilter.length;i++){var s=e.activityFilter[i];r.properties[s]&&r.properties[s].toLowerCase().charAt(0)!=="y"&&delete n[t]}if(e.lengthFilter){var o=!1;e.lengthFilter.length===0&&(o=!0);for(var u=0;u<e.lengthFilter.length;u++){var a=e.lengthFilter[u],h=r.properties.length;if(a.toLowerCase()=="short"&&h<=f||a.toLowerCase()=="medium"&&h>f&&h<=l||a.toLowerCase()=="long"&&h>l&&h<=c||a.toLowerCase()=="verylong"&&h>c){o=!0;break}}o||delete n[t]}if(e.searchFilter){var p=r.properties.name.toLowerCase().indexOf(e.searchFilter.toLowerCase()),d;r.properties.description===null?d=-1:d=r.properties.description.toLowerCase().indexOf(e.searchFilter.toLowerCase());p==-1&&d==-1&&delete n[t]}});Ht(n)}function dt(e){var t=$(e.currentTarget),n=t.attr("data-filter"),r=t.val();console.log(r);mt(n,r)}function vt(e){var t=$(e.currentTarget),n="searchFilter",r=t.val();console.log(t);console.log(r);if(t.hasClass("search-key")){console.log("search key");mt(n,r)}if(t.hasClass("search-submit")&&t.val()!==""){console.log("search submit");mt(n,r)}}function mt(e,t){console.log(t);var n=0;if(e=="activityFilter"){var r=I.activityFilter.length;for(var i=0;i<I.activityFilter.length;i++){var s=I.activityFilter[i];if(s===t){I.activityFilter.splice(i,1);n=1;break}}n===0&&I.activityFilter.push(t)}if(e=="lengthFilter"){console.log("length");console.log(I.lengthFilter.length);var r=I.lengthFilter.length;for(var o=0;o<r;o++){console.log("j");console.log(o);var u=I.lengthFilter[o];if(u==t){console.log("match");I.lengthFilter.splice(o,1);n=1;break}}n===0&&I.lengthFilter.push(t)}if(e=="searchFilter"){console.log("searchFilter");I.searchFilter=t}console.log(I);pt(I,O)}function gt(e){var t=k.getCenter(),n=k.latLngToContainerPoint(t),r=T,i=n.add(r.divideBy(2)),s=k.containerPointToLatLng(i);$(e.target).hasClass("offsetZoomIn")?k.setZoomAround(s,k.getZoom()+1):$(e.target).hasClass("offsetZoomOut")&&k.setZoomAround(s,k.getZoom()-1)}function yt(){j=k.getCenter()}function bt(e){console.log("setupGeolocation");if(navigator.geolocation){var t={enableHighAccuracy:!0,timeout:5e3,maximumAge:3e4};Y=navigator.geolocation.watchPosition(function(t){if(M.length===0){wt(t,e);et=!0}else wt(t)},function(t){if(M.length===0){Et(t,e);et=!0}else Et(t)})}else{B=r;Et("no geolocation",e)}}function wt(e,t){B=new L.LatLng(e.coords.latitude,e.coords.longitude);var n=B.distanceTo(r)/1e3;if(!k){var i,s;if(n<x){j=B;i=B;s=13}else{j=r;i=r;s=11}k=St(i,s)}z||(z=L.userMarker(B,{smallIcon:!0,pulsing:!0,accuracy:0}).addTo(k));console.log(B);z.setLatLng(B);typeof t=="function"&&t()}function Et(e,t){console.log("handleGeoError");console.log(e);if(!k){console.log("making map anyway");k=St(r,11)}if(k&&z&&e.code===3){k.removeLayer(z);z=null}typeof t=="function"&&t()}function St(e,t){console.log("createMap");var r=L.map(A,{zoomControl:!1,scrollWheelZoom:!1});L.tileLayer.provider("MapBox."+n).addTo(r);r.setView(e,t);r.fitBounds(r.getBounds(),{paddingTopLeft:T});r.on("zoomend",function(e){console.log("zoomend");if(h&&W){if(r.getZoom()>=a&&!r.hasLayer(W)){r.addLayer(W);W.bringToBack()}if(r.getZoom()<a&&r.hasLayer(W)){K&&r.removeLayer(K);r.removeLayer(W)}}});r.on("popupclose",kt);return r}function xt(e,t){console.log("getOrderedTrailheads");var n={loc:e.lat+","+e.lng,type:"GET",path:"/trailheads.json?loc="+e.lat+","+e.lng};cn(n,function(e){Tt(e);typeof t=="function"&&t()})}function Tt(e){console.log("populateTrailheadArray");console.log(e);M=[];for(var t=0;t<e.features.length;t++){var n=e.features[t],r=new L.LatLng(n.geometry.coordinates[1],n.geometry.coordinates[0]),i=(new L.CircleMarker(r,{color:"#00adef",fillOpacity:.5,opacity:.8})).setRadius(N),s={properties:n.properties,geometry:n.geometry,marker:i,trails:[],popupContent:""};Nt(s);M.push(s)}}function Nt(e){e.marker.on("click",function(e){return function(){Ct(e)}}(e.properties.id))}function Ct(e){console.log("trailheadMarkerClick");tn(e,0);var t=Yt(e);Rt(O[t.trails[0]],t)}function kt(e){K=null}function Lt(e){console.log("getTrailData");var t={type:"GET",path:"/trails.json"};cn(t,function(t){At(t);typeof e=="function"&&e()})}function At(e){for(var t=0;t<e.features.length;t++)O[e.features[t].properties.id]=e.features[t]}function Ot(e){console.log("getTrailSegments");var t={type:"GET",path:"/trailsegments.json"};cn(t,function(t){_=t;d&&(W=Dt(t));typeof e=="function"&&e()})}function Mt(e){var t=!1;$.each(O,function(n,r){if(O[n].properties.name==e){t=n;return!1}});return t}function _t(e){for(var t=0;t<=6;t++){var n="trail"+t;if(Mt(e.properties[n])){console.log("segment match");return!0}}console.log("segment non-match");return!1}function Dt(e){if(n!==undefined)return n;console.log("makeAllSegmentLayer");nt=[];tt=[];var n=new L.FeatureGroup,r=L.geoJson(e,{style:function(){return{color:v,weight:m,opacity:1,clickable:!1}},onEachFeature:function(t,n){nt.push(n)}}),i=L.geoJson(e,{style:function(){return{opacity:0,weight:20,clickable:!0,smoothFactor:10}},onEachFeature:function(t,n){tt.push(n)}}),s=tt.length;for(var o=0;o<s;o++){var u=tt[o],a=new L.FeatureGroup([tt[o],nt[o]]),f=$("<div class='trail-popup'>");for(var l=1;l<=6;l++){var c="trail"+l;if(u.feature.properties[c]){var h;Mt(u.feature.properties[c])?h=$("<div class='trail-popup-line trail-popup-line-named'>").attr("data-steward",u.feature.properties.steward).attr("data-source",u.feature.properties.source).attr("data-trailname",u.feature.properties[c]).html(u.feature.properties[c]).css("color","black"):h=$("<div class='trail-popup-line trail-popup-line-unnamed'>").html(u.feature.properties[c]);f.append(h)}}u.feature.properties.popupHTML=f.outerHTML();var p;t?p="click":p="mouseover";a.addEventListener(p,function(t){return function(n){console.log("new mouseover");if(X){clearTimeout(X);X=null}if(V){clearTimeout(V);V=null}V=setTimeout(function(n,r){return function(){r.setStyle({weight:y,color:g});r!=J&&J&&J.setStyle({weight:m,color:v});var e=t.feature.properties.popupHTML;console.log(e);K=(new L.Popup).setContent(e).setLatLng(n.latlng).openOn(k);J=r}}(n,n.target),250)}}(u));a.addEventListener("mouseout",function(e){if(X){clearTimeout(X);X=null}if(V){clearTimeout(V);V=null}X=setTimeout(function(e){return function(){e.target.setStyle({weight:3})}}(e),1250)});n.addLayer(a)}nt=null;tt=null;return n}function Pt(e){console.log("trailPopupLineClick");var t=$(e.target).attr("data-trailname"),n=$(e.target).attr("data-source"),r=[];for(var i=0;i<M.length;i++){var s=M[i];s.properties.source==n&&(s.properties.trail1==t||s.properties.trail2==t||s.properties.trail3==t||s.properties.trail4==t||s.properties.trail5==t||s.properties.trail6)&&r.push(s)}var o=K._latlng,u=Infinity,a=null;for(var f=0;f<r.length;f++){var l=r[f],c=l.marker.getLatLng(),h=o.distanceTo(c);if(h<u){a=l;u=h}}var p=0,d=null;for(var v=0;v<a.trails.length;v++){var m=a.trails[v];if(O[m].properties.name==t){d=O[m];p=v}}tn(a.properties.id,p);Rt(d,a)}function Ht(e){console.log("addTrailDataToTrailheads");console.log(O);for(var t=0;t<M.length;t++){var n=M[t];n.trails=[];for(var r=1;r<=3;r++){var i="trail"+r;if(n.properties[i]==="")continue;var s=n.properties[i];$.each(e,function(e,t){n.properties[i]==t.properties.name&&n.trails.push(e)})}}Bt(M);jt(M);Ft(M);It(M)}function Bt(e){console.log("fixDuplicateTrailNames");for(var t=0;t<e.length;t++){var n=e[t],r={};for(var i=0;i<n.trails.length;i++){var s=O[n.trails[i]].properties.name;r[s]=r[s]||[];var o={source:O[n.trails[i]].properties.source,trailID:O[n.trails[i]].properties.id};r[s].push(o)}for(var u in r)if(r.hasOwnProperty(u)&&r[u].length>1)for(var a=0;a<r[u].length;a++){var f=r[u][a];if(f.source!=n.properties.source){var l=f.trailID,c=$.inArray(l.toString(),n.trails);n.trails.splice(c,1)}}}}function jt(e){for(var t=0;t<e.length;t++){var n=e[t],r=$("<div>").addClass("trailhead-popup"),i=$("<div>").addClass("trailhead-box").html($("<div class='popupTrailheadNames'>"+n.properties.name+"</div>")).appendTo(r);i.append($("<img>").addClass("calloutTrailheadIcon").attr({src:"img/icon_trailhead_active.png"}));for(var s=0;s<n.trails.length;s++){var o=O[n.trails[s]],u=$("<div>").addClass("trailhead-trailname trail"+(s+1)).attr("data-trailname",o.properties.name).attr("data-trailid",o.properties.id).attr("data-trailheadname",n.properties.name).attr("data-trailheadid",n.properties.id).attr("data-index",s);console.log(o.properties.status);var a="";o.properties.status==1&&u.append($("<img>").addClass("status").attr({src:"img/icon_alert_yellow.png",title:"alert"}));o.properties.status==2&&u.append($("<img>").addClass("status").attr({src:"img/icon_alert_red.png",title:"alert"}));u.append("<div class='popupTrailNames'>"+o.properties.name+"</div>");u.append("<b>").appendTo(i)}n.popupContent=r.outerHTML()}}function Ft(e){console.log("mapActiveTrailheads");var t=[];for(var n=0;n<e.length;n++)e[n].trails.length&&t.push(e[n].marker);if(F){console.log("remove");k.removeLayer(F)}F=L.layerGroup(t);k.addLayer(F);F.eachLayer(function(e){typeof e.bringToBack=="function"&&e.bringToBack()})}function It(e){console.log("makeTrailDivs");q=[];var t=1;$("#trailList").html("");$.each(e,function(e,n){var r=n.properties.name,i=n.properties.id,s=n.trails;if(s.length===0)return!0;var o=n.properties.source,u=qt(n.properties.distance),a;for(var f=0;f<s.length;f++){var l=s[f],c=O[l],h=O[l].properties.name,p=O[l].properties.length,d=t++;a=$("<div>").addClass("trail-box").attr("data-source","list").attr("data-trailid",l).attr("data-trailname",h).attr("data-trail-length",p).attr("data-trailheadName",r).attr("data-trailheadid",i).attr("data-index",f).appendTo("#trailList").click(Qt).click(function(e,t){return function(n){Rt(e,t)}}(c,n));var v=$("<div>").addClass("trailInfo").appendTo(a),m=$("<div>").addClass("trailheadInfo").appendTo(a);$("<div class='trailSource' id='"+o+"'>"+o+"</div>").appendTo(a);$("<div class='trailCurrentIndex' >"+d+"</div>").appendTo(v);$("<div class='trail' >"+h+"</div>").appendTo(v);var g=p==1?"mile":"miles";$("<div class='trailLength' >"+p+" "+g+" long"+"</div>").appendTo(v);$("<img class='trailheadIcon' src='img/icon_trailhead_active.png'/>").appendTo(m);$("<div class='trailheadName' >"+r+" Trailhead"+"</div>").appendTo(m);$("<div class='trailheadDistance' >"+u+" miles away"+"</div>").appendTo(m);var y={trailID:l,trailheadID:i,index:f};q.push(y)}if(s.length===0){a=$("<div class='trail-box'>").appendTo("#trailList");$("<span class='trail' id='list|"+r+"'>"+r+" - NO TRAILS ("+[val.properties.trail1,val.properties.trail2,val.properties.trail3].join(", ")+")</span>").appendTo(a);$("<span class='trailSource'>"+o+"</span>").appendTo(a)}});console.log(q)}function qt(e){return(e*s).toFixed(1)}function Rt(e,t){console.log("showTrailDetails");if($(".detailPanel").is(":hidden")){$t(e,t);Ut();R=e;U=t}else if(R==e&&U==t){R=null;U=null;zt()}else{$t(e,t);R=e;U=t}}function Ut(){console.log("openDetailPanel");$(".detailPanel").show();$(".accordion").hide();$(".trailhead-trailname.selected").addClass("detail-open")}function zt(){console.log("closeDetailPanel");$(".detailPanel").hide();$(".accordion").show();$(".trailhead-trailname.selected").removeClass("detail-open")}function Wt(){console.log("toggleDetailPanelControls");$(".detailPanelControls").toggle()}function Xt(e){console.log("changeDetailPanel");var t=U.properties.id,n=String(R.properties.id);console.log(n);var r;for(var i=0;i<q.length;i++)q[i].trailID==n&&q[i].trailheadID==t&&(G=i);var s=!1;if($(e.target).hasClass("controlRight")){G+=1;s=!0}if($(e.target).hasClass("controlLeft")&&G>0){G-=1;s=!0}if(s){var o=q[G];t=o.trailheadID;var u=o.index;for(var a=0;a<M.length;a++)M[a].properties.id==t&&(r=M[a]);Vt();tn(t,u);Rt(O[r.trails[u]],r)}}function Vt(){G===0?$(".controlLeft").removeClass("enabled").addClass("disabled"):$(".controlLeft").removeClass("disabled").addClass("enabled");G==q.length-1?$(".controlRight").removeClass("enabled").addClass("disabled"):$(".controlRight").removeClass("disabled").addClass("enabled");return G}function $t(e,t){console.log(G);for(var n=0;n<q.length;n++)q[n].trailID==e.properties.id&&q[n].trailheadID==t.properties.id&&(G=n);Vt();$(".detailFooter").show();$(".detailPanel .detailPanelBanner .trailName").html(e.properties.name+" ("+(G+1)+" of "+q.length+" trails)");$(".detailPanel .detailPanelBanner .trailIndex").html(G+1+" of "+q.length);$(".detailPanel .detailPanelBanner .trailName").html(e.properties.name);$(".detailPanel .detailTrailheadName").html(t.properties.name);if(e.properties.medium_photo_url){$(".detailPanel .detailPanelPicture").attr("src",e.properties.medium_photo_url);$(".detailPanel .detailPanelPictureCredits").remove();$(".detailPanel .detailPanelPictureContainer").append("<div class='detailPanelPictureCredits'>Photo courtesy of "+e.properties.photo_credit+"</div>")}$(".detailPanel .detailPanelPictureContainer .statusMessage").remove();if(e.properties.status==1){$(".detailPanel .detailPanelPictureCredits").remove();$(".detailPanel .detailPanelPictureContainer").append("<div class='statusMessage' id='yellow'><img src='img/icon_alert_yellow.png'><span>"+e.properties.statustext+"</span>"+"</div>")}if(e.properties.status==2){$(".detailPanel .detailPanelPictureCredits").remove();$(".detailPanel .detailPanelPictureContainer").append("<div class='statusMessage' id='red'><img src='img/icon_alert_red.png'><span>"+e.properties.statustext+"</span>"+"</div>")}if(e.properties.hike=="y"){console.log("hike icon replaced");$(".detailPanel .detailTopRow#right #hike").html("<img class='activity-icons' src='img/icon_hike_green.png'>")}if(e.properties.roadbike=="y"){console.log("cycle icon replaced");$(".detailPanel .detailTopRow#right #cycle").html("<img class='activity-icons' src='img/icon_cycle_green.png'>")}if(e.properties.accessible=="y"){console.log("handicap icon replaced");$(".detailPanel .detailTopRow#right #handicap").html("<img class='activity-icons' src='img/icon_handicap_green.png'>")}if(e.properties.equestrian=="y"){console.log("horse icon replaced");$(".detailPanel .detailTopRow#right #horse").html("<img class='activity-icons' src='img/icon_horse_green.png'>")}if(e.properties.xcntryski=="y"){console.log("xcntryski icon replaced");$(".detailPanel .detailTopRow#right #xcountryski").html("<img class='activity-icons' src='img/icon_xcountryski_green.png'>")}if(t.properties.parking=="yes"){console.log("parking icon added");$(".detailPanel .detailBottomRow .detailTrailheadAmenities .detailTrailheadIcons").html("<img class='amenity-icons' src='img/icon_parking_green.png'>")}$(".detailPanel .detailTrailheadDistance").html(qt(t.properties.distance)+" miles away");var r=e.properties.length=="1"?"mile":"miles";$(".detailPanel .detailLength").html(e.properties.length+" "+r);$(".detailPanel .detailDifficulty").html(e.properties.difficulty);$(".detailPanel .detailDescription").html(e.properties.description);if(e.properties.map_url){$(".detailPanel .detailPrintMap a").attr("href",e.properties.map_url).attr("target","_blank");$(".detailPanel .detailPrintMap").show()}else $(".detailPanel .detailPrintMap").hide();var s="http://maps.google.com?saddr="+B.lat+","+B.lng+"&daddr="+t.geometry.coordinates[1]+","+t.geometry.coordinates[0];$(".detailPanel .detailDirections a").attr("href",s).attr("target","_blank");$(".detailPanel .detailBottomRow .detailTrailheadAmenities .detailTrailheadIcons");if(e.properties.steward){e.properties.steward_logo_url&&e.properties.steward_logo_url.indexOf("missing.png")==-1&&$(".detailPanel .detailStewardLogo").attr("src",i+e.properties.steward_logo_url);$(".detailPanel .detailFooter .detailSteward").html(e.properties.steward_fullname).attr("href",e.properties.steward_url).attr("target","_blank");$(".detailPanel .detailFooter .detailStewardPhone").html(e.properties.steward_phone)}else $(".detailFooter").hide()}function Jt(e){console.log("trailnameClick");Gt(e)}function Kt(e){console.log(e);var t=e.data("trailheadid"),n=e.data("index")||0,r=e.data("trailid"),i={trailheadID:t,highlightedTrailIndex:n,trailID:r};return i}function Qt(e){console.log("populateTrailsForTrailheadDiv");var t;e.target!==this?t=$(this):t=$(e.target);var n=Kt(t);tn(n.trailheadID,n.highlightedTrailIndex)}function Gt(e){console.log($(e.target).data("trailheadid"));var t;$(e.target).data("trailheadid")?t=$(e.target):t=$(e.target.parentNode);var n=Kt(t);console.log(n);var r=Yt(n.trailheadID);tn(n.trailheadID,n.highlightedTrailIndex);var i=O[n.trailID];Rt(i,r)}function Yt(e){var t;for(var n=0;n<M.length;n++)if(M[n].properties.id==e){t=M[n];break}return t}function Zt(e,t){var n=$(e.popupContent);n.find(".trailhead-trailname").removeClass("selected").addClass("not-selected");if(t!=-1){var r=e.trails[t],i='[data-trailid="'+r+'"]',s=n.find(i);s.addClass("selected").removeClass("not-selected")}e.popupContent=n.outerHTML();$(".detailPanel").is(":visible")&&$(".trailhead-trailname.selected").addClass("detail-open")}function tn(e,t){console.log("highlightTrailhead");t=t||0;var n=null;n=Yt(e);$(".detailPanel").is(":visible")&&$(".trailhead-trailname.selected").removeClass("detail-open");if(Q){k.removeLayer(Q.marker);Q.marker=(new L.CircleMarker(Q.marker.getLatLng(),{color:"#00adef",fillOpacity:.5,opacity:.8,zIndexOffset:100})).setRadius(N).addTo(k);Nt(Q)}$(".detailPanel").is(":visible")&&$(".trailhead-trailname.selected").addClass("detail-open");Q=n;k.removeLayer(Q.marker);Q.marker=(new L.Marker(Q.marker.getLatLng(),{icon:st})).addTo(k);Nt(Q);nn(n,t);Zt(n,t);var r=(new L.Popup({offset:[0,-12],autoPanPadding:[100,100]})).setContent(n.popupContent).setLatLng(n.marker.getLatLng()).openOn(k)}function nn(e,t){console.log("getAllTrailPathsForTrailhead");_.type=="FeatureCollection"&&p?sn(e,t):rn(e,t)}function rn(e,t){console.log("getAllTrailPathsForTrailheadRemote");var n=[],r=[];for(var i=0;i<e.trails.length;i++){var s=e.trails[i],o=O[s].properties.name,u="select st_collect(the_geom) the_geom, '"+o+"' trailname from "+ft+" segments where "+"(segments.trail1 = '"+o+"' or "+"segments.trail2 = '"+o+"' or "+"segments.trail3 = '"+o+"' or "+"segments.trail4 = '"+o+"' or "+"segments.trail5 = '"+o+"' or "+"segments.trail6 = '"+o+"' or "+"segments.trail1 = '"+o+" Trail' or "+"segments.trail2 = '"+o+" Trail' or "+"segments.trail3 = '"+o+" Trail' or "+"segments.trail4 = '"+o+" Trail' or "+"segments.trail5 = '"+o+" Trail' or "+"segments.trail6 = '"+o+" Trail') and "+"(source = '"+O[s].properties.source+"' or "+(o=="Ohio & Erie Canal Towpath Trail")+")",a=function(e,t){return function(e){var r={type:"GET",path:"/trailsegments.json"};cn(r,function(r){n[t]=r;e(null,s)})}}(u,i);r.push(a)}async.parallel(r,function(e,r){n=on(n);un(n);fn(t)})}function sn(e,t){console.log("getAllTrailPathsForTrailheadLocal");var n=[],r=[];for(var i=0;i<e.trails.length;i++){var s=e.trails[i],o=O[s],u=o.properties.source,a=o.properties.name,f={type:"FeatureCollection",features:[{geometry:{geometries:[],type:"GeometryCollection"},type:"Feature"}]},l=0;for(var c=0;c<_.features.length;c++){var h=$.extend(!0,{},_.features[c]);if((h.properties.trail1==a||h.properties.trail1+" Trail"==a||h.properties.trail2==a||h.properties.trail2+" Trail"==a||h.properties.trail3==a||h.properties.trail3+" Trail"==a||h.properties.trail4==a||h.properties.trail4+" Trail"==a||h.properties.trail5==a||h.properties.trail5+" Trail"==a||h.properties.trail6==a||h.properties.trail6+" Trail"==a)&&(h.properties.source==u||a=="Ohio & Erie Canal Towpath Trail")){f.features[0].properties={trailname:a};l=1;f.features[0].geometry.geometries.push(h.geometry)}}l&&r.push(f)}console.log(r);n=on(r);un(n);fn(t)}function on(e){console.log("mergeResponses");var t=$.extend(!0,{},e[0]);if(t.features){t.features[0].properties.order=0;for(var n=1;n<e.length;n++){t.features=t.features.concat(e[n].features);t.features[n].properties.order=n}}else console.log("ERROR: missing segment data for trail.");return t}function un(e){console.log("drawMultiTrailLayer");if(D){k.removeLayer(D);P=[]}e.features[0].geometry===null&&alert("No trail segment data found.");D=L.geoJson(e,{style:function(e){var t;if(e.properties.order===0||!e.properties.order)return{weight:m,color:v,opacity:1,clickable:!1};if(e.properties.order===1)return{weight:m,color:v,opacity:1,clickable:!1};if(e.properties.order===2)return{weight:m,color:v,opacity:1,clickable:!1}},onEachFeature:function(e,t){P.push(t)}}).addTo(k).bringToFront();ln(D)}function an(e){var t=$("<div class='"+e+"'>").hide().appendTo("body"),n=t.css("background-color");console.log(n);t.remove();return n}function fn(e){console.log("setCurrentTrail");H&&typeof H.setStyle=="Function"&&H.setStyle({weight:m,color:v});P[e]?H=P[e]:console.log("ERROR: trail layer missing");H.setStyle({weight:w,color:b})}function ln(e){console.log("zoomToLayer");var t=k.getBoundsZoom(e.getBounds());console.log(e.getLayers().length);console.log(["layerBoundsZoom:",t]);if(t<=o&&t>=u)k.fitBounds(e.getBounds(),{paddingTopLeft:T});else{var n=t>o?o:t;n=n<u?u:n;console.log("setview newZoom:");console.log(n);k.setView(Q.marker.getLatLng(),n)}}function cn(e,t){console.log("makeAPICall");$.isEmptyObject(e.data)||(e.data=JSON.stringify(e.data));var n=i+e.path,r=$.ajax({type:e.type,url:n,dataType:"json",contentType:"application/json; charset=utf-8",data:e.data}).fail(function(e,t,n){console.log("error! "+n+" "+t);console.log(e.status);$("#results").text("error: "+JSON.stringify(n))}).done(function(e,n,r){typeof t=="function"&&t.call(this,e)})}console.log("trailhead.js");var e;Modernizr.mq("only screen and (max-width: 529px)")?e=!0:Modernizr.mq("only screen and (min-width: 530px)")&&(e=!1);var t=$("html").hasClass("touch"),n="codeforamerica.map-j35lxf9d",r={lat:41.1,lng:-81.5},i="http://127.0.0.1:3000";if(window.location.hostname.split(".")[0]=="trailsy-dev")i="http://trailsyserver-dev.herokuapp.com";else if(window.location.hostname.split(".")[0]=="trailsy"||window.location.hostname=="www.tothetrails.com")i="http://trailsyserver-prod.herokuapp.com";var s=62137e-8,o=17,u=14,a=13,f=2,l=5,c=10,h=1,p=!0,d=e?!0:!0,v="#678729",m=3,g="#678729",y=6,b="#445617",w=9,E="#FF0000",S=3,x=100,T=e?new L.point(0,0):new L.Point(450,0),N=t?15:4,C=5,k,A=e?"trailMapSmall":"trailMapLarge",O={},M=[],_=[],D={},P=[],H={},B={},j={},F,I={lengthFilter:[],activityFilter:[],searchFilter:""},q=[],R=null,U=null,z=null,W=null,X=null,V=null,J=null,K=null,Q=null,G,Y=null,Z=null,et=!1,tt=[],nt=[],rt={iconSize:[15.6,19.8],iconAnchor:[7.8,19.8],popupAnchor:[0,-3]},it=$.extend(rt,{iconUrl:"img/icon_trailhead_active.png"}),st=L.icon(it),ot=$.extend(rt,{iconUrl:"img/icon_trailhead_active.png"}),ut=L.icon(ot),at="summit_trailheads",ft="summit_trailsegments",lt="summit_traildata";$("#redoSearch").click(ht);$(document).on("click",".trailhead-trailname",Jt);$(document).on("click",".closeDetail",zt);$(document).on("click",".detailPanelControls",Xt);$(document).on("change",".filter",dt);$(document).on("click",".trail-popup-line-named",Pt);$(".search-key").keyup(function(e){vt(e)});$(".offsetZoomControl").click(gt);$(".search-submit").click(vt);$(".detailPanel").hover(Wt,Wt);ct();var en;jQuery.fn.outerHTML=function(e){return e?this.before(e).remove():jQuery("<p>").append(this.eq(0).clone()).html()}}console.log("start");$(document).ready(startup);